/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
import { of } from 'rxjs';
import { map, delay, switchMap, catchError } from 'rxjs/operators';
import { copyToClipboard, mergeDeep } from './utils';
/**
 * Meta tags operator - Serialize meta tags into the sharer URL
 * @type {?}
 */
export const metaTagsOperators = [
    map((ref) => {
        // Social network sharer URL */
        /** @type {?} */
        const SharerURL = ref.prop.share[ref.platform];
        if (SharerURL) {
            // object contains supported meta tags
            /** @type {?} */
            const metaTags = ref.prop.share.metaTags;
            // object contains meta tags values */
            /** @type {?} */
            const metaTagsValues = ref.metaTags;
            /** @type {?} */
            let link = '';
            // Set each meta tag with user value
            if (metaTags) {
                link = Object.entries(metaTags).map(([key, metaTag]) => metaTagsValues[key] ? `${metaTag}=${encodeURIComponent(metaTagsValues[key])}` : '').join('&');
            }
            return SharerURL + link;
        }
        return;
    })
];
/**
 * Print button operator
 * @type {?}
 */
export const printOperators = [
    map((ref) => ref.document.defaultView.print())
];
/**
 * Copy link to clipboard, used for copy button
 * @type {?}
 */
export const copyOperators = [
    map((ref) => {
        // Disable the button
        ref.renderer.setStyle(ref.el, 'pointer-events', 'none');
        ref.temp = { text: ref.prop.text, icon: ref.prop.icon };
        ref.metaTags.url = decodeURIComponent(ref.metaTags.url);
        return ref;
    }),
    switchMap((ref) => copyToClipboard(ref).pipe(map(() => {
        ref.prop.text = ref.prop.successText;
        ref.prop.icon = ref.prop.successIcon;
        return ref;
    }), catchError(() => {
        ref.prop.text = ref.prop.failText;
        ref.prop.icon = ref.prop.failIcon;
        return of(ref);
    }))),
    map((ref) => {
        ref.cd.markForCheck();
        return ref;
    }),
    delay(2000),
    map((ref) => {
        // Enable the button
        ref.renderer.setStyle(ref.el, 'pointer-events', 'auto');
        // Reset copy button text and icon */
        ref.prop.text = ref.temp.text;
        ref.prop.icon = ref.temp.icon;
        ref.cd.markForCheck();
    })
];
/**
 * Add the share URL to message body, used for WhatsApp and Email buttons
 * @type {?}
 */
export const urlInMessageOperators = [
    map((ref) => {
        /** @type {?} */
        const description = ref.metaTags.description;
        /** @type {?} */
        const url = ref.metaTags.url;
        /** @type {?} */
        const newRef = {
            metaTags: {
                description: description ? `${description}\r\n${url}` : url
            }
        };
        return mergeDeep(ref, newRef);
    })
];
/** @type {?} */
export const FacebookCountOperators = [
    map((res) => +res.share.share_count)
];
/** @type {?} */
export const PinterestCountOperators = [
    map((text) => JSON.parse(text.replace(/^receiveCount\((.*)\)/, '$1'))),
    map((res) => +res.count)
];
/** @type {?} */
export const TumblrCountOperators = [
    map((res) => +res.response.note_count)
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hhcmUub3BlcmF0b3JzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQG5neC1zaGFyZS9jb3JlLyIsInNvdXJjZXMiOlsibGliL3NoYXJlLm9wZXJhdG9ycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLEVBQUUsRUFBb0IsTUFBTSxNQUFNLENBQUM7QUFDNUMsT0FBTyxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBTyxNQUFNLGdCQUFnQixDQUFDO0FBRXhFLE9BQU8sRUFBRSxlQUFlLEVBQUUsU0FBUyxFQUFFLE1BQU0sU0FBUyxDQUFDOzs7OztBQUtyRCxNQUFNLE9BQU8saUJBQWlCLEdBQWlDO0lBQzdELEdBQUcsQ0FBQyxDQUFDLEdBQW1CLEVBQUUsRUFBRTs7O2NBR3BCLFNBQVMsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDO1FBQzlDLElBQUksU0FBUyxFQUFFOzs7a0JBR1AsUUFBUSxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVE7OztrQkFHbEMsY0FBYyxHQUFHLEdBQUcsQ0FBQyxRQUFROztnQkFFL0IsSUFBSSxHQUFHLEVBQUU7WUFDYixvQ0FBb0M7WUFDcEMsSUFBSSxRQUFRLEVBQUU7Z0JBQ1osSUFBSSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLEVBQUUsRUFBRSxDQUNyRCxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsT0FBTyxJQUFJLGtCQUFrQixDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FDbkYsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDYjtZQUNELE9BQU8sU0FBUyxHQUFHLElBQUksQ0FBQztT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QUFPLFNBQVMsQ0FBQyxHQUFHLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDaEMsQ0FBQyxDQUFDO0NBQ0g7O0FBRUQsTUFBTSxPQUFPLHNCQUFzQixHQUFpQztJQUNsRSxHQUFHLENBQUMsQ0FBQyxHQUFRLEVBQUUsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUM7Q0FDMUM7O0FBRUQsTUFBTSxPQUFPLHVCQUF1QixHQUFpQztJQUNuRSxHQUFHLENBQUMsQ0FBQyxJQUFZLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyx1QkFBdUIsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQzlFLEdBQUcsQ0FBQyxDQUFDLEdBQVEsRUFBRSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDO0NBQzlCOztBQUVELE1BQU0sT0FBTyxvQkFBb0IsR0FBaUM7SUFDaEUsR0FBRyxDQUFDLENBQUMsR0FBUSxFQUFFLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDO0NBQzVDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgb2YsIE9wZXJhdG9yRnVuY3Rpb24gfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgbWFwLCBkZWxheSwgc3dpdGNoTWFwLCBjYXRjaEVycm9yLCB0YXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IFNoYXJlQnV0dG9uUmVmIH0gZnJvbSAnLi9zaGFyZS5tb2RlbHMnO1xyXG5pbXBvcnQgeyBjb3B5VG9DbGlwYm9hcmQsIG1lcmdlRGVlcCB9IGZyb20gJy4vdXRpbHMnO1xyXG5cclxuLyoqXHJcbiAqIE1ldGEgdGFncyBvcGVyYXRvciAtIFNlcmlhbGl6ZSBtZXRhIHRhZ3MgaW50byB0aGUgc2hhcmVyIFVSTFxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IG1ldGFUYWdzT3BlcmF0b3JzOiBPcGVyYXRvckZ1bmN0aW9uPGFueSwgYW55PltdID0gW1xyXG4gIG1hcCgocmVmOiBTaGFyZUJ1dHRvblJlZikgPT4ge1xyXG5cclxuICAgIC8vIFNvY2lhbCBuZXR3b3JrIHNoYXJlciBVUkwgKi9cclxuICAgIGNvbnN0IFNoYXJlclVSTCA9IHJlZi5wcm9wLnNoYXJlW3JlZi5wbGF0Zm9ybV07XHJcbiAgICBpZiAoU2hhcmVyVVJMKSB7XHJcblxyXG4gICAgICAvLyBvYmplY3QgY29udGFpbnMgc3VwcG9ydGVkIG1ldGEgdGFnc1xyXG4gICAgICBjb25zdCBtZXRhVGFncyA9IHJlZi5wcm9wLnNoYXJlLm1ldGFUYWdzO1xyXG5cclxuICAgICAgLy8gb2JqZWN0IGNvbnRhaW5zIG1ldGEgdGFncyB2YWx1ZXMgKi9cclxuICAgICAgY29uc3QgbWV0YVRhZ3NWYWx1ZXMgPSByZWYubWV0YVRhZ3M7XHJcblxyXG4gICAgICBsZXQgbGluayA9ICcnO1xyXG4gICAgICAvLyBTZXQgZWFjaCBtZXRhIHRhZyB3aXRoIHVzZXIgdmFsdWVcclxuICAgICAgaWYgKG1ldGFUYWdzKSB7XHJcbiAgICAgICAgbGluayA9IE9iamVjdC5lbnRyaWVzKG1ldGFUYWdzKS5tYXAoKFtrZXksIG1ldGFUYWddKSA9PlxyXG4gICAgICAgICAgbWV0YVRhZ3NWYWx1ZXNba2V5XSA/IGAke21ldGFUYWd9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KG1ldGFUYWdzVmFsdWVzW2tleV0pfWAgOiAnJ1xyXG4gICAgICAgICkuam9pbignJicpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBTaGFyZXJVUkwgKyBsaW5rO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuO1xyXG4gIH0pXHJcbl07XHJcblxyXG4vKipcclxuICogUHJpbnQgYnV0dG9uIG9wZXJhdG9yXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgcHJpbnRPcGVyYXRvcnM6IE9wZXJhdG9yRnVuY3Rpb248YW55LCBhbnk+W10gPSBbXHJcbiAgbWFwKChyZWY6IFNoYXJlQnV0dG9uUmVmKSA9PiByZWYuZG9jdW1lbnQuZGVmYXVsdFZpZXcucHJpbnQoKSlcclxuXTtcclxuXHJcbi8qKlxyXG4gKiBDb3B5IGxpbmsgdG8gY2xpcGJvYXJkLCB1c2VkIGZvciBjb3B5IGJ1dHRvblxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IGNvcHlPcGVyYXRvcnM6IE9wZXJhdG9yRnVuY3Rpb248YW55LCBhbnk+W10gPSBbXHJcbiAgbWFwKChyZWY6IFNoYXJlQnV0dG9uUmVmKSA9PiB7XHJcblxyXG4gICAgLy8gRGlzYWJsZSB0aGUgYnV0dG9uXHJcbiAgICByZWYucmVuZGVyZXIuc2V0U3R5bGUocmVmLmVsLCAncG9pbnRlci1ldmVudHMnLCAnbm9uZScpO1xyXG5cclxuICAgIHJlZi50ZW1wID0ge3RleHQ6IHJlZi5wcm9wLnRleHQsIGljb246IHJlZi5wcm9wLmljb259O1xyXG4gICAgcmVmLm1ldGFUYWdzLnVybCA9IGRlY29kZVVSSUNvbXBvbmVudChyZWYubWV0YVRhZ3MudXJsKTtcclxuICAgIHJldHVybiByZWY7XHJcbiAgfSksXHJcbiAgc3dpdGNoTWFwKChyZWY6IFNoYXJlQnV0dG9uUmVmKSA9PiBjb3B5VG9DbGlwYm9hcmQocmVmKS5waXBlKFxyXG4gICAgbWFwKCgpID0+IHtcclxuICAgICAgcmVmLnByb3AudGV4dCA9IHJlZi5wcm9wLnN1Y2Nlc3NUZXh0O1xyXG4gICAgICByZWYucHJvcC5pY29uID0gcmVmLnByb3Auc3VjY2Vzc0ljb247XHJcbiAgICAgIHJldHVybiByZWY7XHJcbiAgICB9KSxcclxuICAgIGNhdGNoRXJyb3IoKCkgPT4ge1xyXG4gICAgICByZWYucHJvcC50ZXh0ID0gcmVmLnByb3AuZmFpbFRleHQ7XHJcbiAgICAgIHJlZi5wcm9wLmljb24gPSByZWYucHJvcC5mYWlsSWNvbjtcclxuICAgICAgcmV0dXJuIG9mKHJlZik7XHJcbiAgICB9KVxyXG4gICkpLFxyXG4gIG1hcCgocmVmOiBTaGFyZUJ1dHRvblJlZikgPT4ge1xyXG4gICAgcmVmLmNkLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgcmV0dXJuIHJlZjtcclxuICB9KSxcclxuICBkZWxheSgyMDAwKSxcclxuICBtYXAoKHJlZjogU2hhcmVCdXR0b25SZWYpID0+IHtcclxuXHJcbiAgICAvLyBFbmFibGUgdGhlIGJ1dHRvblxyXG4gICAgcmVmLnJlbmRlcmVyLnNldFN0eWxlKHJlZi5lbCwgJ3BvaW50ZXItZXZlbnRzJywgJ2F1dG8nKTtcclxuXHJcbiAgICAvLyBSZXNldCBjb3B5IGJ1dHRvbiB0ZXh0IGFuZCBpY29uICovXHJcbiAgICByZWYucHJvcC50ZXh0ID0gcmVmLnRlbXAudGV4dDtcclxuICAgIHJlZi5wcm9wLmljb24gPSByZWYudGVtcC5pY29uO1xyXG4gICAgcmVmLmNkLm1hcmtGb3JDaGVjaygpO1xyXG4gIH0pXHJcbl07XHJcblxyXG4vKipcclxuICogQWRkIHRoZSBzaGFyZSBVUkwgdG8gbWVzc2FnZSBib2R5LCB1c2VkIGZvciBXaGF0c0FwcCBhbmQgRW1haWwgYnV0dG9uc1xyXG4gKi9cclxuZXhwb3J0IGNvbnN0IHVybEluTWVzc2FnZU9wZXJhdG9yczogT3BlcmF0b3JGdW5jdGlvbjxhbnksIGFueT5bXSA9IFtcclxuICBtYXAoKHJlZjogU2hhcmVCdXR0b25SZWYpID0+IHtcclxuICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcmVmLm1ldGFUYWdzLmRlc2NyaXB0aW9uO1xyXG4gICAgY29uc3QgdXJsID0gcmVmLm1ldGFUYWdzLnVybDtcclxuICAgIGNvbnN0IG5ld1JlZjogU2hhcmVCdXR0b25SZWYgPSB7XHJcbiAgICAgIG1ldGFUYWdzOiB7XHJcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uID8gYCR7ZGVzY3JpcHRpb259XFxyXFxuJHt1cmx9YCA6IHVybFxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIG1lcmdlRGVlcChyZWYsIG5ld1JlZik7XHJcbiAgfSlcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBGYWNlYm9va0NvdW50T3BlcmF0b3JzOiBPcGVyYXRvckZ1bmN0aW9uPGFueSwgYW55PltdID0gW1xyXG4gIG1hcCgocmVzOiBhbnkpID0+ICtyZXMuc2hhcmUuc2hhcmVfY291bnQpXHJcbl07XHJcblxyXG5leHBvcnQgY29uc3QgUGludGVyZXN0Q291bnRPcGVyYXRvcnM6IE9wZXJhdG9yRnVuY3Rpb248YW55LCBhbnk+W10gPSBbXHJcbiAgbWFwKCh0ZXh0OiBzdHJpbmcpID0+IEpTT04ucGFyc2UodGV4dC5yZXBsYWNlKC9ecmVjZWl2ZUNvdW50XFwoKC4qKVxcKS8sICckMScpKSksXHJcbiAgbWFwKChyZXM6IGFueSkgPT4gK3Jlcy5jb3VudClcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBUdW1ibHJDb3VudE9wZXJhdG9yczogT3BlcmF0b3JGdW5jdGlvbjxhbnksIGFueT5bXSA9IFtcclxuICBtYXAoKHJlczogYW55KSA9PiArcmVzLnJlc3BvbnNlLm5vdGVfY291bnQpXHJcbl07XHJcbiJdfQ==